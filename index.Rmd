---
title       : Mixed-mode distributions
subtitle    : Analysis of multi-mode distributions using R 'mixtools' package
author      : James Elvy
job         : Coursera Datascience Specialisation
framework   : io2012        # {io2012, html5slides, shower, dzslides, html5rocks, landslide, deck.js}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
---

## What are multi-mode distributions?
1.	Multi-mode distributions the have more than one ‘mode’.  
2.	They are typically composed of several component distributions, each with their own mean and standard deviation.
3.	The resulting ‘shape’ of the distribution depends on the relative proportions (number of points) of each of the component distributions
4.	They are common in 'natural populations' but problematic to deal with

--- .class #id 

## The R ‘mixtools’ package:
1.	The mixtools package takes an input distribution as an argument
2.	The ‘normalmixEM’ function can be used to decompose a distribution to ‘normal distribution’ components.
3.	You can specify the number of modes you want to investigate
4.	You can specify the number of iterations
5.	It works best with larger datasets

--- .class #id 

## Analysis example:
```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# http://www.r-bloggers.com/visually-weighted-regression-in-r-a-la-solomon-hsiang/
# http://rstudio-pubs-static.s3.amazonaws.com/1001_3177e85f5e4840be840c84452780db52.html# mixtools
library(mixtools)    # install.packages("mixtools")

# component distribution parameters
comp.proportions <- c(500, 400, 100)
comp.means <- c(1.5, 3, 8)
comp.stdevs <- c(1.5, 2, 4)

# create component distributions
comp.1 <- rnorm(comp.proportions[1], mean=comp.means[1], sd=comp.stdevs[1]); den.comp.1 <- density(comp.1)
comp.2 <- rnorm(comp.proportions[2], mean=comp.means[2], sd=comp.stdevs[2]); den.comp.2 <- density(comp.2)
comp.3 <- rnorm(comp.proportions[3], mean=comp.means[3], sd=comp.stdevs[3]); den.comp.3 <- density(comp.3)

# build up mix distribution
mix <- c(comp.1, comp.2, comp.3)

# Use mixtools to generate decomposition
mixModel <- normalmixEM(mix, lambda=NULL, mu=NULL, sigma=NULL, k=3)   # k=3 as we expect three populations are sampled
```
A tri-modal distribution was synthesised from 10,000 data points randomly sampled from three normally distributed populations in the following component proportions 50%, 40% and 10%).

```{r, echo=FALSE, results='asis', message=FALSE, warning=FALSE, fig.width=12, fig.height=6}
# 2 figures arranged in 1 row and 2 columns
par(mfrow=c(1,2))
# plot of mixed distribution
hist(mix, freq = F, main = "Synthesized tri-modal distribution", xlab = "Data")    # proportions
lines(den.comp.1$x, den.comp.1$y * (comp.proportions[1] / sum(comp.proportions)), col = "red", lwd = 2)
lines(den.comp.2$x, den.comp.2$y * (comp.proportions[2] / sum(comp.proportions)), col = "blue", lwd = 2)
lines(den.comp.3$x, den.comp.3$y * (comp.proportions[3] / sum(comp.proportions)), col = "green", lwd = 2)

# Use mixtools to generate decomposition
plot(mixModel, which = 2, main2 = "Decomposition of tri-modal distribution using 'mixtools'")
```

--- .class #id 

## Results
The input parameters of the component distributions are:
```{r, echo=TRUE, results='hide', message=FALSE, warning=FALSE}
comp.proportions <- c(5000, 4000, 500)
comp.means <- c(1.5, 3, 8)
comp.stdevs <- c(1.5, 2, 4)
```
The output of the ‘normalmixEM” function is:
```{r, echo=FALSE, results='markup', message=FALSE, warning=FALSE}
summary(mixModel)
```
Interactive shiny app here: https://jameselvy.shinyapps.io/CourseraDataProductsShiny/

Source code: https://jameselvy.github.com/DataProductsSlidify
